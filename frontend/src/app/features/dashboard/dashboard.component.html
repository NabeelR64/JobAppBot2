<div class="dashboard-container">
    <!-- Header -->
    <div class="dashboard-header">
        <div class="header-left">
            <h1>My Applications</h1>
            <span class="app-count" *ngIf="!loading">{{ totalApplications }} total</span>
        </div>
        <div class="header-actions">
            <div class="search-box">
                <span class="search-icon">ğŸ”</span>
                <input type="text" placeholder="Search company or role..." [(ngModel)]="searchQuery"
                    (ngModelChange)="onSearchChange()" class="search-input" />
            </div>
            <button class="sort-btn" (click)="toggleSort()"
                [title]="'Sort by ' + (sortMode === 'date' ? 'company name' : 'date')">
                {{ sortMode === 'date' ? 'ğŸ“… Newest' : 'ğŸ”¤ Aâ€“Z' }}
            </button>
            <button class="btn-danger" (click)="deleteAccount()">Delete Account</button>
        </div>
    </div>

    <!-- Loading State -->
    <div class="loading-state" *ngIf="loading">
        <div class="spinner"></div>
        <p>Loading applications...</p>
    </div>

    <!-- Empty State -->
    <div class="empty-state" *ngIf="!loading && totalApplications === 0">
        <div class="empty-icon">ğŸ“‹</div>
        <h3>No applications yet</h3>
        <p>Start swiping on jobs to see your applications tracked here!</p>
    </div>

    <!-- Kanban Board -->
    <div class="kanban-board" *ngIf="!loading && totalApplications > 0">
        <div class="kanban-column" *ngFor="let column of columns">
            <div class="column-header" [style.border-top-color]="column.color">
                <span class="column-icon">{{ column.icon }}</span>
                <span class="column-title">{{ column.title }}</span>
                <span class="column-count" [style.background-color]="column.color">{{ column.applications.length
                    }}</span>
            </div>

            <div class="column-body" cdkDropList [id]="column.id" [cdkDropListData]="column.applications"
                [cdkDropListConnectedTo]="connectedDropLists" (cdkDropListDropped)="onDrop($event, column)">

                <div *ngFor="let app of column.applications" cdkDrag class="drag-wrapper">
                    <app-application-card [application]="app" (statusChanged)="onCardStatusChanged($event)">
                    </app-application-card>
                </div>

                <div class="column-empty" *ngIf="column.applications.length === 0">
                    <p>No applications</p>
                </div>
            </div>
        </div>
    </div>
</div>